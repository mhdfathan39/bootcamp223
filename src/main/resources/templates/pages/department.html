<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  xmlns:with="http://www.thymeleaf.org/extras/with" layout:decorate="~{layout}" with:title="'B210'">
<th:block layout:fragment="content">
  <div class="bottom">
    <div class="col">
      <div class="container">
        <button class="btn btn-success nBtn"> New Department </button>
        <div class="card">
          <div class="card-block">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th>Department Id</th>
                  <th>Department Name</th>
                  <th>Location Id</th>
                  <th> </th>
                </tr>
              </thead>
              <tbody>
                <tr th:each="dept :${departments}">
                  <td th:text="${dept.departmentId}"></td>
                  <td th:text="${dept.departmentName}"></td>
                  <td th:text="${dept.locationId}"></td>
                  <td>
                    <a th:href="@{/department/edit/(id=${dept.departmentId})}" class="btn btn-primary eBtn">Edit</a>
                    <a th:href="@{/department/delete/(id=${dept.departmentId})}" class="btn btn-danger delBtn">Delete</a>
                  </td>
                </tr>
              </tbody>
            </table>
            <hr />
          </div>
          <div class="modal-body">
            <!-- Content will be loaded here...  -->

          </div>
        </div>
      </div>
    </div>
  </div>
</th:block>

<th:block layout:fragment="dept">
  <script>
    // AJAX request
    $(".nBtn, .table .eBtn").click(function () {
      event.preventDefault();
      var href = $(this).attr('href');
      var text = $(this).text();
      console.log('text : ' + text);
      if (text == 'Edit') {
        console.log('href : ' + href);

        $.ajax({
          url: '/department/add',
          dataType: 'html',
          type: 'get',
          // data: {},
          // data: { userid: userid },
          success: function (response) {
             console.log('reponse : ' + response);
            // Add response in Modal body
            $('.modal-body').html(response);

            $.get(href, function (dept, status) {

              $('.myFormUpdate #departmentId').val(dept.departmentId);
              $('.myFormUpdate #departmentName').val(dept.departmentName);
              $('.myFormUpdate #locationId').val(dept.locationId);

            });

            // Display Modal
            $('.myFormUpdate #updateModal').modal('show');
          }
        });

      } else {
        // AJAX request
        $.ajax({
          url: '/department/add',
          dataType: 'html',
          type: 'get',
          // data: {},
          // data: { userid: userid },
          success: function (response) {
            console.log('reponse : ' + response);
            // Add response in Modal body
            $('.modal-body').html(response);

            // Display Modal
            $('.myFormCreate #myModalCreate').modal('show');
          }
        });

      }

    });

 

  </script>

</th:block>